<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>特色产品测试</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .lang-btn { margin: 10px; padding: 5px 10px; cursor: pointer; }
        .lang-btn.active { background: #007bff; color: white; }
        #featured-products { border: 1px solid #ddd; min-height: 300px; padding: 15px; }
        .section-title { color: #333; }
        .section-subtitle { color: #666; }
        .products-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .product-card { border: 1px solid #eee; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>特色产品多语言测试</h1>
    
    <div>
        <button id="btn-zh" class="lang-btn active" onclick="switchLang('zh')">中文</button>
        <button id="btn-en" class="lang-btn" onclick="switchLang('en')">English</button>
    </div>
    
    <div id="featured-products">
        <!-- 特色产品将在这里显示 -->
    </div>
    
    <div id="debug-info" style="margin-top: 20px; font-size: 12px; color: #666;">
        <!-- 调试信息 -->
    </div>

    <script src="js/i18n.js"></script>
    <script src="js/featured-products.js"></script>
    <script>
        let currentFeaturedProducts = null;
        
        function updateDebugInfo(msg) {
            const debugEl = document.getElementById('debug-info');
            debugEl.innerHTML += '<p>' + new Date().toLocaleTimeString() + ': ' + msg + '</p>';
            console.log('DEBUG:', msg);
        }
        
        function switchLang(lang) {
            updateDebugInfo('切换语言到: ' + lang);
            
            // 更新按钮状态
            document.getElementById('btn-zh').classList.toggle('active', lang === 'zh');
            document.getElementById('btn-en').classList.toggle('active', lang === 'en');
            
            // 使用i18n切换语言
            if (window.i18n) {
                window.i18n.switchLanguage(lang);
            } else {
                updateDebugInfo('i18n对象不存在，手动重新加载');
                if (currentFeaturedProducts) {
                    currentFeaturedProducts.loadFeaturedProducts();
                }
            }
        }
        
        function initTest() {
            updateDebugInfo('开始初始化测试');
            
            // 检查依赖
            updateDebugInfo('i18n存在: ' + !!window.i18n);
            updateDebugInfo('FeaturedProducts存在: ' + !!window.FeaturedProducts);
            
            // 初始化特色产品
            if (window.FeaturedProducts) {
                try {
                    currentFeaturedProducts = new window.FeaturedProducts();
                    currentFeaturedProducts.init();
                    updateDebugInfo('特色产品初始化成功');
                } catch (e) {
                    updateDebugInfo('特色产品初始化失败: ' + e.message);
                }
            }
        }
        
        // 页面加载后初始化
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(initTest, 500); // 稍等一下让所有脚本加载完成
        });
        
        // 监听语言切换事件
        window.addEventListener('languageChanged', function(e) {
            updateDebugInfo('收到语言切换事件: ' + e.detail.language);
        });
    </script>
</body>
</html>